---
title: Variation of dietary fiber content in 282 common bean genotypes from the middle
  american gene pool
author: "skammlade"
date: "31 May 2016"
output:
  pdf_document:
    fig_caption: yes
    includes:
      in_header: preamble_fig_env.tex
    latex_engine: pdflatex
    toc: yes
    toc_depth: 2
  html_document:
    toc: yes
  word_document: default
header-includes: 
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{floatrow}
  - \floatsetup[table]{capposition=top}
graphics: yes
sansfont: Calibri Light
fontsize: 12pt
---

\renewcommand{\sfdefault}{phv}

## Introduction

`r nrow(fiber)/2` entries from the BeanCAP study were grown in Fort Collins, CO in 2015 to determine variation in fiber content. All entries originated from the Middle American gene pool and were further subdivided into the following races and market classes: 

| Race | # Entries |
-------|----------
Durango | `r sum(fiber$race=="durango", na.rm=TRUE)/2`
Jalisco | `r sum(fiber$race=="jalisco", na.rm=TRUE)/2`
Mesoamerican | `r sum(fiber$race=="mesoamerican", na.rm=TRUE)/2`

Table: Number of entries representing each race.

| Market Class | # Entries |
------------ | ----------
pinto | `r sum(fiber$mktclass=="pinto", na.rm=TRUE)/2`
navy | `r sum(fiber$mktclass=="navy", na.rm=TRUE)/2`
black | `r sum(fiber$mktclass=="black", na.rm=TRUE)/2`
GN | `r sum(fiber$mktclass=="GN", na.rm=TRUE)/2`
small red | `r sum(fiber$mktclass=="small red", na.rm=TRUE)/2`
pink | `r sum(fiber$mktclass=="pink", na.rm=TRUE)/2`
carioca | `r sum(fiber$mktclass=="carioca", na.rm=TRUE)/2`
tan | `r sum(fiber$mktclass=="tan", na.rm=TRUE)/2`
black mottle | `r sum(fiber$mktclass=="black mottle", na.rm=TRUE)/2`
flor de mayo | `r sum(fiber$mktclass=="flor de mayo", na.rm=TRUE)/2`
red mottle | `r sum(fiber$mktclass=="red mottle", na.rm=TRUE)/2`

Table: Number of entries representing each market class.

## Results: Entry Rankings

Tables below show the five entries with the greatest and five entries with the lowest values of each fiber component averaged across the two replications including standard deviation (sd), standard error (se) and confindence intervals (ci).

## - Insoluble Dietary Fiber (IDF) 
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(data.table)
library(knitr)
fiber<- read.csv("fiber.csv")
source('summarySE.R')
summ.IDF <-summarySE(fiber, measurevar="IDF", groupvars=c("Entry","mktclass","race"))
summ.IDF <- data.frame(summ.IDF)
#summ.f <- summ.F[fiber$ftype=="IDF", ]
f.IDF <- subset(summ.IDF, select=c(Entry, mktclass, race, IDF, sd, se, ci))
newdata <- f.IDF[order(-f.IDF$IDF), ]
newdata[,4:7] <- round(newdata[,4:7], 2)
DT <- data.table(newdata)
head <- head(DT, 5)
kable(head, caption="Five entries with greatest IDF content.")
tail <- tail(DT,5)
kable(tail, caption="Five entries with lowest IDF content.")
```

## -  Soluble Dietary Fiber (SDF)
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(data.table)
fiber<- read.csv("fiber.csv")
source('summarySE.R')
summ.SDF <-summarySE(fiber, measurevar="SDF", groupvars=c("Entry","mktclass","race"))
summ.SDF <- data.frame(summ.SDF)
#summ.f <- summ.F[fiber$ftype=="SDF", ]
f.SDF <- subset(summ.SDF, select=c(Entry, mktclass, race, SDF, sd, se, ci))
newdata <- f.SDF[order(-f.SDF$SDF), ]
newdata[,4:7] <- round(newdata[,4:7], 2)
DT <- data.table(newdata)
head <- head(DT, 5)
kable(head, caption="Five entries with greatest SDF content.")
tail <- tail(DT,5)
kable(tail, caption="Five entries with lowest SDF content.")
```

## -  Raffinose (Raff)
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(data.table)
fiber<- read.csv("fiber.csv")
source('summarySE.R')
summ.Raff <-summarySE(fiber, measurevar="Raff", groupvars=c("Entry","mktclass","race"))
summ.Raff <- data.frame(summ.Raff)
#summ.f <- summ.F[fiber$ftype=="Raff", ]
f.Raff <- subset(summ.Raff, select=c(Entry, mktclass, race, Raff, sd, se, ci))
newdata <- f.Raff[order(-f.Raff$Raff), ]
newdata[,4:7] <- round(newdata[,4:7], 2)
DT <- data.table(newdata)
head <- head(DT, 5)
kable(head, caption="Five entries with greatest raffinose content.")
tail <- tail(DT,5)
kable(tail, caption="Five entries with lowest raffinose content.")
```

## -  Stachyose (Stach)
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(data.table)
fiber<- read.csv("fiber.csv")
source('summarySE.R')
summ.stach <-summarySE(fiber, measurevar="Stach", groupvars=c("Entry","mktclass","race"))
summ.stach <- data.frame(summ.stach)
#summ.f <- summ.F[fiber$ftype=="Stach", ]
f.stach <- subset(summ.stach, select=c(Entry, mktclass, race, Stach, sd, se, ci))
newdata <- f.stach[order(-f.stach$Stach), ]
newdata[,4:7] <- round(newdata[,4:7], 2)
DT <- data.table(newdata)
head <- head(DT, 5)
kable(head, caption="Five entries with greatest stachyose content.")
tail <- tail(DT,5)
kable(tail, caption="Five entries with lowest stachyose content.")
```

## -  Verbascose (Verb)
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(data.table)
fiber<- read.csv("fiber.csv")
source('summarySE.R')
summ.Verb <-summarySE(fiber, measurevar="Verb", groupvars=c("Entry","mktclass","race"))
summ.Verb <- data.frame(summ.Verb)
#summ.f <- summ.F[fiber$ftype=="Verb", ]
f.Verb <- subset(summ.Verb, select=c(Entry, mktclass, race, Verb, sd, se, ci))
newdata <- f.Verb[order(-f.Verb$Verb), ]
newdata[,4:7] <- round(newdata[,4:7], 3)
DT <- data.table(newdata)
head <- head(DT, 5)
kable(head, caption="Five entries with greatest verbascose content.")
tail <- tail(DT,5)
kable(tail, caption="Five entries with lowest verbascose content.")
```

## -  Total Oligosachharides (TOligos)
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(data.table)
fiber<- read.csv("fiber.csv")
source('summarySE.R')
summ.TOligos <-summarySE(fiber, measurevar="TOligos", groupvars=c("Entry","mktclass","race"))
summ.TOligos <- data.frame(summ.TOligos)
#summ.f <- summ.F[fiber$ftype=="TOligos", ]
f.TOligos <- subset(summ.TOligos, select=c(Entry, mktclass, race, TOligos, sd, se, ci))
newdata <- f.TOligos[order(-f.TOligos$TOligos), ]
newdata[,4:7] <- round(newdata[,4:7], 2)
DT <- data.table(newdata)
head <- head(DT, 5)
kable(head, caption="Five entries with greatest total oligosaccharide (= Raff + Stach + Verb) content.")
tail <- tail(DT,5)
kable(tail, caption="Five entries with lowest total oligosaccharide (= Raff + Stach + Verb) content.")
```

## -  Total Dietary Fiber (TDF) 

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Table #. Total Dietary Fiber top 5 and bottom 5."}
library(data.table)
fiber<- read.csv("fiber.csv")
source('summarySE.R')
summ.TDF <-summarySE(fiber, measurevar="TDF", groupvars=c("Entry","mktclass","race"))
summ.TDF <- data.frame(summ.TDF)
#summ.f <- summ.F[fiber$ftype=="TDF", ]
f.TDF <- subset(summ.TDF, select=c(Entry, mktclass, race, TDF, sd, se, ci))
newdata <- f.TDF[order(-f.TDF$TDF), ]
newdata[,4:7] <- round(newdata[,4:7], 2)
DT <- data.table(newdata)
head <- head(DT, 5)
kable(head, caption="Five entries with greatest total DF (= IDF + SDF + Raff + Stach + Verb) content.")
tail <- tail(DT,5)
kable(tail, caption="Five entries with lowest total DF (= IDF + SDF + Raff + Stach + Verb) content.")
```


## Results: Marketclass

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(data.table)
fiber.one<- read.csv("fiber_facet.csv")
```


##   -   Boxplots
Figures below depict fiber content by market class. 
```{r echo=FALSE, message=FALSE, warning=FALSE}
source('subset.race.R')
```


```{r fig.width = 8, fig.height=8, fig.align='center', echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Oligosaccharide content in 282 common bean genotypes by marketclass (A) Raffinose, (B) Stachyose, (C) Verbascose, and (D) total oligosaccharides (= Raff + Stach + Verb)."}
##Boxplots by Marketclass: Oligosaccharides
source('boxplot.mktclass.R')
plot_grid(p.Verb.mkt, p.Raff.mkt, p.Stach.mkt, p.TOligos.mkt, labels = c("A", "B", "C", "D"), ncol = 2)
```

| Marketclass | Verbascose | Raffinose | Stachyose | Total Oligosaccharides |
---------|--------|--------|---------|---------|
black | `r round(mean(verb.black$value),3)` a | `r round(mean(raff.black$value),3)` c | `r round(mean(stach.black$value),2)` b | `r round(mean(toligos.black$value),2)` bc |
black mottle | `r round(mean(verb.blackmottle$value),3)` ab | `r round(mean(raff.blackmottle$value),3)` bc | `r round(mean(stach.blackmottle$value),2)` ab | `r round(mean(toligos.blackmottle$value),2)` ab |
carioca | `r round(mean(verb.carioca$value),3)` ab | `r round(mean(raff.carioca$value),3)` bc | `r round(mean(stach.carioca$value),2)` ab | `r round(mean(toligos.carioca$value),2)` abc |
flor de mayo | `r round(mean(verb.flordemayo$value),3)` abd | `r round(mean(raff.flordemayo$value),3)` bc | `r round(mean(stach.flordemayo$value),2)` ab | `r round(mean(toligos.flordemayo$value),2)` abc |
GN | `r round(mean(verb.GN$value),3)` b | `r round(mean(raff.GN$value),3)` ac | `r round(mean(stach.GN$value),2)` b | `r round(mean(toligos.GN$value),2)` bc |
navy | `r round(mean(verb.navy$value),3)` ac | `r round(mean(raff.navy$value),3)` ac | `r round(mean(stach.navy$value),2)` a | `r round(mean(toligos.navy$value),2)` a |
pink | `r round(mean(verb.pink$value),3)` bc | `r round(mean(raff.pink$value),3)` b | `r round(mean(stach.pink$value),2)` ab | `r round(mean(toligos.pink$value),2)` ab |
pinto | `r round(mean(verb.pinto$value),3)` b | `r round(mean(raff.pinto$value),3)` b | `r round(mean(stach.pinto$value),2)` b | `r round(mean(toligos.pinto$value),2)` b |
red mottle | `r round(mean(verb.redmottle$value),3)` d | `r round(mean(raff.redmottle$value),3)` ab | `r round(mean(stach.redmottle$value),2)` c | `r round(mean(toligos.redmottle$value),2)` c |
small red | `r round(mean(verb.smallred$value),3)` b | `r round(mean(raff.smallred$value),3)` ab | `r round(mean(stach.smallred$value),2)` b | `r round(mean(toligos.smallred$value),2)` bc |
small white | `r round(mean(verb.smallwhite$value),3)` ab | `r round(mean(raff.smallwhite$value),3)` bc | `r round(mean(stach.smallwhite$value),2)` ab | `r round(mean(toligos.smallwhite$value),2)` abc |
tan | `r round(mean(verb.tan$value),3)` ab | `r round(mean(raff.tan$value),3)` bc | `r round(mean(stach.tan$value),2)` ab | `r round(mean(toligos.tan$value),2)` ab |

```{r fig.width = 8, fig.height=5, fig.align='center', echo=FALSE, message=FALSE, warning=FALSE, fig.cap="(A) Soluble and (B) insoluble dietary fiber in 282 common bean genotypes by marketclass,"}
##Boxplots by Marketclass: Soluble and Insoluble DF
source('boxplot.mktclass.R')
plot_grid(p.IDF.mkt, p.SDF.mkt, labels = c("A", "B"), ncol = 2)
```

| Marketclass | Insoluble DF | Soluble DF
---------|--------|--------
black | `r round(mean(idf.black$value),3)` cd | `r round(mean(sdf.black$value),3)` b 
black mottle | `r round(mean(idf.blackmottle$value),3)` abc | `r round(mean(sdf.blackmottle$value),3)` ab 
carioca | `r round(mean(idf.carioca$value),3)` abc | `r round(mean(sdf.carioca$value),3)` ab
flor de mayo | `r round(mean(idf.flordemayo$value),3)` abc | `r round(mean(sdf.flordemayo$value),3)` ab
GN | `r round(mean(idf.GN$value),3)` ab | `r round(mean(sdf.GN$value),3)` ab 
navy | `r round(mean(idf.navy$value),3)` a | `r round(mean(sdf.navy$value),3)` ab 
pink | `r round(mean(idf.pink$value),3)` abc | `r round(mean(sdf.pink$value),3)` a 
pinto | `r round(mean(idf.pinto$value),3)` bd | `r round(mean(sdf.pinto$value),3)` b 
red mottle | `r round(mean(idf.redmottle$value),3)` abc | `r round(mean(sdf.redmottle$value),3)` ab 
small red | `r round(mean(idf.smallred$value),3)` c | `r round(mean(sdf.smallred$value),3)` ab 
small white | `r round(mean(idf.smallwhite$value),3)` abc | `r round(mean(sdf.smallwhite$value),3)` ab 
tan | `r round(mean(idf.tan$value),3)` abc | `r round(mean(sdf.tan$value),3)` ab 

```{r fig.width = 4, fig.height=5, fig.align='center', echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Total Dietary Fiber content in 282 common bean genotypes by marketclass"}
##Boxplots by Marketclass: Total Dietary Fiber
source('boxplot.mktclass.R')
p.TDF.mkt
```

| Marketclass | Total DF 
---------|--------
black | `r round(mean(tdf.black$value),3)` bc 
black mottle | `r round(mean(tdf.blackmottle$value),3)` abc 
carioca | `r round(mean(tdf.carioca$value),3)` abc 
flor de mayo | `r round(mean(tdf.flordemayo$value),3)` abc
GN | `r round(mean(tdf.GN$value),3)` cd 
navy | `r round(mean(tdf.navy$value),3)` a 
pink | `r round(mean(tdf.pink$value),3)` bd 
pinto | `r round(mean(tdf.pinto$value),3)` ac 
red mottle | `r round(mean(tdf.redmottle$value),3)` bc 
small red | `r round(mean(tdf.smallred$value),3)` b 
small white | `r round(mean(tdf.smallwhite$value),3)` abc 
tan | `r round(mean(tdf.tan$value),3)` abc 

## Results: Race

```{r echo=FALSE, message=FALSE, warning=FALSE}
source('subset.race_real.R')
```

##   -   Boxplots
Figures below depict fiber content by race.

```{r fig.width = 8, fig.height=8, fig.align='center', echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Oligosaccharide content in 282 common bean genotypes by race (A) Raffinose, (B) Stachyose, (C) Verbascose, and (D) total oligosaccharides (= Raff + Stach + Verb)."}
##Boxplots by race: Oligosaccharides
source('boxplot.race.R')
plot_grid(p.Verb.race, p.Raff.race, p.Stach.race, p.TOligos.race, labels = c("A", "B", "C", "D"), ncol = 2, align="w")
```

| Race | Verbascose | Raffinose | Stachyose | Total Oligosaccharides |
---------|--------:|--------:|---------:|---------:|
Durango | `r round(mean(verb.durango$value),3)` b | `r round(mean(raff.durango$value),3)` a | `r round(mean(stach.durango$value),2)` b | `r round(mean(toligos.durango$value),2)` a |
Jalisco | `r round(mean(verb.jalisco$value),3)` b | `r round(mean(raff.jalisco$value),3)` a | `r round(mean(stach.jalisco$value),2)` ab | `r round(mean(toligos.jalisco$value),2)` a |
Mesoamerican | `r round(mean(verb.meso$value),3)` a | `r round(mean(raff.meso$value),3)` b | `r round(mean(stach.meso$value),2)` a | `r round(mean(toligos.meso$value),2)` a |

```{r fig.width = 8, fig.height=4, fig.align='center', echo=FALSE, message=FALSE, warning=FALSE, fig.cap="(A) Soluble and (B) insoluble dietary fiber in 282 common bean genotypes by race,"}
##Boxplots by race: Soluble and Insoluble DF
source('boxplot.race.R')
plot_grid(p.IDF.race, p.SDF.race, labels = c("A", "B"), ncol = 2, align="w")
```

| Race | Insoluble DF | Soluble DF | 
---------|--------:|--------:|
Durango | `r round(mean(idf.durango$value),3)` a | `r round(mean(sdf.durango$value),3)` a | 
Jalisco | `r round(mean(idf.jalisco$value),3)` b | `r round(mean(sdf.jalisco$value),3)` b | 
Mesoamerican | `r round(mean(idf.meso$value),3)` a | `r round(mean(sdf.meso$value),3)` a |

```{r fig.width = 4, fig.height=4, fig.align='center', echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Total Dietary Fiber content in 282 common bean genotypes by race"}
##Boxplots by race: Total Dietary Fiber
source('boxplot.race.R')
p.TDF.race
```

| Race | Total DF |
---------|--------:|
Durango | `r round(mean(tdf.durango$value),3)` a | 
Jalisco | `r round(mean(tdf.jalisco$value),3)` b | 
Mesoamerican | `r round(mean(tdf.meso$value),3)` a |






geometry:
  - tmargin=2cm
  - bmargin=2cm
  - lmargin=2cm
  - rmargin=3cm
